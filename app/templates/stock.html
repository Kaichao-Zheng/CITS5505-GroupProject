{% extends "base.html" %}

{% block content %}
<div class="navbar">
    <button class="menu">&#9776;</button>
    <span class="title">SmartAnalytics</span>
    <input type="text" id="search" placeholder="Search Product">
    <button onclick="searchProduct()">üîç</button>
</div>

<div class="product-grid" id="product-grid">
    <!-- Products dynamically inserted here -->
</div>

<button class="load-more" onclick="loadMore()">Load more</button>

<script>
    let offset = 0;

    function loadProducts(initial=false) {
        fetch(`/products?offset=${offset}`)
            .then(res => res.json())
            .then(data => {
                const grid = document.getElementById('product-grid');
                data.products.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'product';
                    div.innerHTML = `
                        <img src="/static/placeholder.png" alt="image" class="product-img">
                        <p class="title">${product.name}</p>
                        <span class="tag">Store</span>
                        <button class="price">View Price</button>
                        <p class="vendor">~ Vendor with lowest price now ~</p>
                    `;
                    grid.appendChild(div);
                });
                offset += data.count;
            });
    }

    function loadMore() {
        loadProducts();
    }

    function searchProduct() {
        offset = 0;
        document.getElementById('product-grid').innerHTML = "";
        loadProducts();
    }

    window.onload = () => loadProducts(true);
</script>
{% endblock %}
